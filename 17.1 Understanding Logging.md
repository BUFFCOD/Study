systemd-jornald is the logging service used by systemd to collect and manage log messages from various sources, including the kernel, system services, and user applications:

the kernal
early boot procedures
syslog events
standard output and standard error of services managed by systemd
The systemd-journald is a non-persistent logging system by default.

the rsyslog service reads syslog messages and writes them to different locations like /var/log/messages or /var/log/syslog depending on the distribution.




systemd -> jorunald -> jornunal get info <- other sources (kernel, processes,early boot procedures, syslog events, ) -> rsyslog ( is configured in /etc/rsyslog.conf) you can send this to a log server or write to files in /var/log/*


## viewing systemd journal messages

systemctl status <service_name>  provides a quick overview of the status and recent log messages for a specific service.

```bash
systemctl status sshd
``` 
journalctl is the main command-line tool for viewing and querying the systemd journal logs.

importnt messages are shown in red.

```bash
journalctl
```

journalctl -p <priority_level>  filters log messages based on their priority level. Priority levels range from 0 (emergency) to 7 (debug).

```bash
journalctl -p 3  # shows messages with priority level 3 (error) and higher
``` 
journalctl -u <service_name>  filters log messages for a specific service unit.

```bash
journalctl -u sshd
``` 
journalctl --since "YYYY-MM-DD HH:MM:SS" --until "YYYY-MM-DD HH:MM:SS"  filters log messages within a specific time range.

```bash
journalctl --since "2023-01-01 00:00:00" --until "2023-01-01 23:59:59"
```
journalctl -f  follows the journal log in real-time, similar to the tail -f command.    

```bash
journalctl -f
``` 
journalctl -o <output_format>  changes the output format of the log messages. Common formats include short, json, and verbose.

```bash
journalctl -o json
``` 

Preserving the Systemd Journal



the systemd journal is non-persistent by default, meaning that log messages are stored in memory and lost after a reboot.

persistency is taken care of by the rsyslog service

rsyslog offers all the filtering you need to fine-tune log persistency.

if desired, the systemd journal can be made persistent by creating the /var/log/journal/ directory:

```bash
sudo mkdir -p /var/log/journal
sudo systemd-tmpfiles --create --prefix /var/log/journal
sudo systemctl restart systemd-journald
``` 
systemd journal setting are in /usr/lib/systemd/journald.conf
the setting Storage= can be set to auto, persistent, volatile, or none. ensures that persistency is enabled.

```ini
[Journal]
Storage=persistent
``` 
After making changes to the journald.conf file, restart the systemd-journald service to apply the changes:  

```bash
sudo systemctl restart systemd-journald
``` 
In journal.conf, default settings apply to ensure that the journal can't grow in an unlimited way,

Log rotation triggers monthly
No more than 10% of the filesystem can be used by the journal
Maximum size of 4GB for the journal

use journalctl | grep 'Runtime Journal | System Journal' to check the current storage settings of the journal.

```bash
journalctl | grep 'Runtime Journal\|System Journal'
``` 


17.4 Understanding rsyslog


Rsyslog needs the rsyslogd service to be running

the main configuration file is /etc/rsyslog.conf

Drop-in files can be placed in the /etc/rsyslog.d/ 

each logger line contains three parts: the selector, the action, and optional parameters.

facilities are categories of log messages, such as auth, cron, daemon, kern, mail, syslog, user, and local0 through local7.
severity levels indicate the importance of the log message, ranging from debug (least severe) to emerg (most severe).
destinations specify where the log messages should be sent, such as files, remote servers, or other programs.   

rsyslog is and must be backward compatible with syslog.

in syslog a fixed number of facilites was deined like kern authpriv mail etc


mainly for rsyslog they have logrotate to manage log file sizes and rotations.
logrotate configuration files are located in /etc/logrotate.conf and /etc/logrotate.d/ directory.
logrotate can be configured to rotate logs based on size, time, or other criteria.

when logrotate rotates a log file, it can also compress the old log files to save disk space.