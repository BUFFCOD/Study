## Understanding Context Labels in SELinux

Every object is labeled with a context label.

    user: user specific context
    role: role specific context
    type: flags which type of operations is allowd on this object

In most  configurations only context type matters, so you can safely ignore user and role for RHCSA. 

Many commands supports a -Z options to show current context infomation.

Context types are sued in the rules of the policy to define which source objects has access to which tartget objects.



Most services dont't need additional SELinux configuration. if defaults settings are used. 

When files are created in a directory, they typically inherit the context of the parent directory.

When files are copied they typically inherit the context of the  parent directory.

When files are moved they keep the orginal context

to repair the context for files use

```bash
restorecon <file>

```
Use semanage fcontext to set the file context label. 

This will write the context to the SELinux Policy but it is not written yet to the file system.

Use semanage fcontext -a to set a new context label

use semanage fcontext -m to modify an existing context label

TO enforce the policy setting on the file system use restorecon.

Alternatively, Use touch /.autorelabel to relabel all files to the context that is specificed in the policy

See man semanage-fcontext for documentation.

Use semange fcontext -l -C to show only setting that have changed in the current policy.

## 27.7  Finding the Right Context

If you apply a non-default configuration, check the default configuration context  setting and apply that to the non-default configuration.

Use sealert for tips

Optionally read man pages from selinux-policy-doc but do realize that on the exam you dont have time for that.

## 27.8 Managing SELinux Port Access

Network ports also provided with an SELinux context label.
The SELinux policy is configured to allow default port access.

For any non-default port use semanage port to apply the right label to the port.

Use the example section in man semanage-port for examples

## 27.9 Managing SELinux Booleans

A boolean is an easy-to-use configuration switch to enable or disable specific parts of the SELinux policy.

For an overview of all booleans use semanage boolean -l or getsebool -a

To set boolean use setsebool -P boolean_name on|off

Use semanage boolean -l -C to see all booleans that have a non-default setting.


## 27.10 Troubleshooting SELinux Issues

SELinux uses auditd to write log messages to audit log.

Messages in the audit log may be hard to interpret.

Ensure that sealert is available, it interprets messages from the audit log, applies SELinux AI, and writes meaningful messages to logging.

Run the sealert command, including the UUID messages to get advice on how to troubleshoot specific issues.


IF sealeart fails

Check if the systemd setroubleshoot-server service is running.

check if messages are written to /var/log/audit/audit.log

Copy the relevant messages from /var/log/audit/audit.log to a separate file and analyze it with sealert -a <logfile>

grep AVC /var/log/audit/audit.log to find relevant messages.

sealert -a /var/log/audit/audit.log to analyze all messages in the audit log.



# Troubleshooting SELinux

- If you think that SELinux is blocking access, start by using  
  `setenforce 0` and try again.  
  If it works now, you have confirmed that SELinux is blocking the requested activity.

- Use  
  `grep AVC /var/log/audit/audit.log`  
  to see raw audit messages.  
  Look at the **source context** and **target context**.

- Confirm by using  
  `journalctl | grep sealert`  
  and read the alert message that was generated.

- Install additional documentation with:  
  `dnf install selinux-policy-doc`  
  This provides extra man pages to help you understand what changes are needed.
- Use `sealert -a /var/log/audit/audit.log` to get suggestions on how to fix the issue.